<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <title>jammny`s blog</title>
        <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <meta http-equiv="imagetoolbar" content="no">
        <meta http-equiv="pragma" content="cache">
        <meta http-equiv="cache-control" content="cache">
        <meta http-equiv="vary" content="content-language">
        <meta http-equiv="Cache-control" content="max-age=2592000, public">
        <meta http-equiv="content-style-type" content="text/css">
        <link rel="dns-prefetch" href="."/>
        <link rel="dns-prefetch" href="//www.gstatic.com"/>
        <link rel="dns-prefetch" href="//fonts.gstatic.com"/>
        <link rel="dns-prefetch" href="//fonts.googleapis.com"/>
        <link rel="dns-prefetch" href="//twemoji.maxcdn.com"/>
        <link rel="dns-prefetch" href="//fonts.googleapis.com/css?family=Merriweather:300,700,700italic,300italic|Open+Sans:700,400"/>
        <link rel="stylesheet" type="text/css" href="./theme/css/screen.min.css">
        <link rel="stylesheet" type="text/css" href="./theme/css/highlight.min.css">
        <link rel="stylesheet" type="text/css" href="./theme/css/custom.min.css">
        <link rel="stylesheet" type="text/css" href="./theme/css/twemoji-awesome.min.css">
        <link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=Merriweather:300,700,700italic,300italic|Open+Sans:700,400" />
        <link rel="publisher" href="">
        <link rel="apple-touch-startup-image" href="./theme/images/logo.png">
        <link type="text/plain" rel="socialmedia" href="./socialmedia.txt">
        <meta http-equiv="content-type" content="text/html;charset=utf-8">
        <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"/>
        <meta name="apple-mobile-web-app-capable" content="yes"/>
        <meta name="application-name" content="jammny`s blog"/>
        <meta name="msapplication-starturl" content="http:."/>
        <meta name="msapplication-tooltip" content=""/>
        <meta name="msapplication-window" content="width=1024;height=768"/>
        <meta name="msapplication-task" content="name=jammny`s blog;action-uri=http:.;icon-uri=./theme/images/favicon.ico"/>
        <meta name="msapplication-TileImage" content="./theme/images/apple-touch-icon-144x144.png"/>
        <meta name="msapplication-TileColor" content="#1F1F21"/>
        <meta name="application-name" content="jammny`s blog">
        <meta name="HandheldFriendly" content="True">
        <meta name="MobileOptimized" content="320"/>
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="google-site-verification" content="">
        <meta name="alexaVerifyID" content=""/>
        <meta name="wot-verification" content=""/>
        <meta name="msvalidate.01" content="" />
        <meta name="apple-mobile-web-app-status-bar-style" content="black">
        <meta name="medium" content="mult">
        <meta name="adblock" content="disable">
        <meta name="rating" content="General">
        <meta name="resource-type" content="document">
        <meta name="revisit-after" content="1 days">
        <meta name="revisit" content="1">
        <meta name="robots" content="index,follow">
        <meta name="no-email-collection" content="http://www.unspam.com/noemailcollection/">
        <meta name="twitter:card" content="summary">
        <meta name="twitter:site" content="@">
        <meta property="og:site_name" content="jammny`s blog">
        <meta property="og:locale" content="en">
        <link rel="canonical" href="./yi-dong-an-quan-an-zhuo-ce-shi-huan-jing-da-jian.html">
        <meta property="og:type" content="article">
        <meta property="og:title" content="移动安全 | 安卓测试环境搭建">
        <meta property="og:url" content="yi-dong-an-quan-an-zhuo-ce-shi-huan-jing-da-jian.html">
        <meta property="og:description" content="原创声明：转载本文请标注出处和作者，望尊重作者劳动成果！感谢！ 前言：这里推荐两个测试环境，分别是lineageOS和Kali Nethunter。lineageOS支持开启adb root权限进行frida调试，通过这个 …">
        <meta property="article:published_time" content="星期四, 三月 23, 2023">
        <meta name="twitter:title" content="移动安全 | 安卓测试环境搭建">
        <meta name="twitter:description" content="原创声明：转载本文请标注出处和作者，望尊重作者劳动成果！感谢！ 前言：这里推荐两个测试环境，分别是lineageOS和Kali Nethunter。lineageOS支持开启adb root权限进行frida调试，通过这个 …">
        <meta name="description" content="原创声明：转载本文请标注出处和作者，望尊重作者劳动成果！感谢！ 前言：这里推荐两个测试环境，分别是lineageOS和Kali Nethunter。lineageOS支持开启adb root权限进行frida调试，通过这个 …">
        <meta name="twitter:creator" content="@">
        <meta property="og:image" content="./theme/images/logo.png">
        <meta name="twitter:image" content="./theme/images/logo.png">
        <meta property="og:image:type" content="image/png">
        <meta property="og:image:width" content="300">
        <meta property="og:image:height" content="300">
        <meta property="article:section" content="misc">
        <meta property="article:author" content="jammny">
    </head>
    <body class="post-template nav-closed" itemscope itemtype="http://schema.org/WebPage">
        <meta itemprop="name" content="jammny`s blog">
        <meta itemprop="url" content=".">
        <meta itemprop="headline" content="jammny`s blog || ">
        <meta itemprop="description about" content="blog">
        <meta itemprop="keywords" content="">
        <meta itemprop="inLanguage" content="en">
<nav class="nav">
    <h3 class="nav-title">Menu</h3>
    <a href="#" class="nav-close">
        <span class="hidden">Close</span>
    </a>
    <ul role="menubar">
        <li class="" role="presentation"><a  href="./index.html" title="jammny`s blog" itemprop="name" itemprop="significantLink">Home</a></li>
            <li class="" role="presentation"><a  href="./archives.html" title="jammny`s blog | Archives" itemprop="name" itemprop="significantLink">Archives</a></li>
    </ul>
</nav>
<span class="nav-cover"></span>        <div class="site-wrapper">
            <header class="main-header post-head" style="background-image: url('');" itemscope itemtype="http://schema.org/WPHeader">
                <nav class="main-nav overlay clearfix">
                    <a class="menu-button" href="#">
                        <span class="burger">&#9776;</span>
                        <span class="word">Menu</span>
                    </a>
                </nav>
                <div class="vertical">
                    <div class="main-header-content inner">
                    </div>
                </div>
            </header>
<main id="content" class="content" role="main">
    <article class="post" itemscope="" itemtype="http://schema.org/BlogPosting" itemprop="blogPost">
        <header class="post-header">
            <h1 class="post-title" itemprop="headline">移动安全 | 安卓测试环境搭建</h1>
            <section class="post-meta">
                <time class="post-date" itemprop="datePublished" datetime="2023YYY-11M-%DD">星期四, 三月 23, 2023</time>
                on             </section>
        </header>
        <section class="post-content">
            <p><code>原创声明：转载本文请标注出处和作者，望尊重作者劳动成果！感谢！</code></p>
<blockquote>
<p>前言：这里推荐两个测试环境，分别是lineageOS和Kali Nethunter。lineageOS支持开启adb root权限进行frida调试，通过这个特性能绕过大部分root检测。Kali Nethunter通过magisk获取root权限，满足日常的APP测试学习之外，还能进行近源渗透测试攻击。</p>
</blockquote>
<p><a name="MPE5x"></a></p>
<h1>一、lineageOS搭建</h1>
<blockquote>
<p>测试机型：Pixel 2 (walleye)</p>
</blockquote>
<p><a name="iefyS"></a></p>
<h2>1.1 刷入TWRP</h2>
<p><a name="JJUDE"></a></p>
<h3>1.1.1 TWRP下载安装</h3>
<p>1、TWRP是一个第三方的recovery，下载地址：<a href="https://twrp.me/Devices/">https://twrp.me/Devices/</a><br /><img alt="image.png" src="images/1679569866903_0.png"><br />2、选择美版，然后下载最新的镜像和压缩包。<br /><img alt="image.png" src="images/1679569867092_1.png">
<a name="h6fGe"></a></p>
<h3>1.1.2 刷入临时TWRP</h3>
<p>1、解锁 Bootloader</p>
<div class="highlight"><pre><span></span><code><span class="n">adb</span><span class="w"> </span><span class="n">devices</span>
<span class="n">adb</span><span class="w"> </span><span class="n">reboot</span><span class="w"> </span><span class="n">bootloader</span>
<span class="n">fastboot</span><span class="w"> </span><span class="n">flashing</span><span class="w"> </span><span class="n">unlock</span>
<span class="n">fastboot</span><span class="w"> </span><span class="n">reboot</span>
</code></pre></div>

<p>2、adb传入镜像</p>
<div class="highlight"><pre><span></span><code>adb push .\twrp-pixel2-installer-walleye-3.3.0-0.zip /data/local/tmp
</code></pre></div>

<p>3、启动TWRP镜像</p>
<div class="highlight"><pre><span></span><code><span class="n">adb</span><span class="w"> </span><span class="n">reboot</span><span class="w"> </span><span class="n">bootloader</span>
<span class="n">fastboot</span><span class="w"> </span><span class="n">boot</span><span class="w"> </span><span class="n">twrp</span><span class="o">-</span><span class="mf">3.3</span><span class="o">.</span><span class="mi">0</span><span class="o">-</span><span class="mi">0</span><span class="o">-</span><span class="n">walleye</span><span class="o">.</span><span class="n">img</span>
</code></pre></div>

<p><a name="gBl7n"></a></p>
<h3>1.1.3 安装TWRP</h3>
<p>进入后解锁 —&gt; 滑块往右滑动 —&gt; install —&gt; 进入/data/local/tmp —&gt; 选择 twrp-pixel2-installer-walleye-3.3.0-0.zip 包安装。
<a name="cQQCf"></a></p>
<h2>1.2 刷入lineageOS</h2>
<p><a name="q1CLN"></a></p>
<h3>1.2.1 下载刷机包</h3>
<p>地址：<a href="https://download.lineageos.org/walleye">https://download.lineageos.org/walleye</a><br /><img alt="image.png" src="images/1679569867279_2.png">
<a name="vnFnl"></a></p>
<h3>1.2.2 ADB Sideload 模式刷机</h3>
<p>1、切换到 TWRP 的 ADB Sideload 模式，<code>adb sideload 【你下载的压缩包】</code><br />2、等待成功后重启就完事了。
<a name="p7sR6"></a></p>
<h1>二、Kali Nethunter</h1>
<blockquote>
<p>前言：安装这个有啥用？简单来说就是可以在你的手机平台上运行KALI Linux系统，实际用处，懂得都懂。在综合考虑的情况下，入手了一台Oneplus6，因此下面的刷入流程是以Oneplus6为参考标准。官方推荐刷入机型：<a href="https://www.kali.org/get-kali/#kali-mobile">https://www.kali.org/get-kali/#kali-mobile</a></p>
</blockquote>
<p><a name="cpWTv"></a></p>
<h2>2.1 刷机准备</h2>
<ol>
<li>我整理好了刷机工具，下载并分别解压好，如下图所示：</li>
</ol>
<p><img alt="image.png" src="images/1679569867477_3.png"></p>
<ol>
<li>刷机工具下载地址：</li>
</ol>
<div class="highlight"><pre><span></span><code>https://www.aliyundrive.com/s/KptykyqdNmP
</code></pre></div>

<p><a name="xgOMq"></a></p>
<h2>2.2 刷机过程</h2>
<p><a name="K5nOQ"></a></p>
<h3>2.2.1 线刷Oxygen10.3.2</h3>
<p>1、安装好9008驱动。<br /><img alt="image.png" src="images/1679569867666_4.png"></p>
<p>2、安装成功后，打开“MsmDownloadTool V4.0.exe”会显示如下数据：<br /><img alt="image.png" src="images/1679569867833_5.png"><br />3、手机拔出数据线后，彻底关机（长按关机键不放，直到熄屏）。<br />4、按着音量上键不放，同时插入数据线到电脑。软件会自动识别，当显示“已连接”后，点击“start”，开始刷机。<br /><img alt="image.png" src="images/1679569868039_6.png"><br />5、线刷完成后，手机自动重启进去新系统。<br /><img alt="image.png" src="images/1679569868218_7.png">
<a name="lmXRF"></a></p>
<h3>2.2.2 解锁OEM</h3>
<p>1、进去系统后，不用配置任何东西，一路跳过。（<strong>不要插SIM卡</strong>！<strong>不要联网</strong>！<strong>不要设置指纹密码</strong> ！）<br />2、进入到“关于手机”，一直点击“版本号”直到开启“开发者模式”。<br /><img alt="image.png" src="images/1679569868371_8.png"><br />3、打开“开发者选项”，开启“OEM解锁”和“USB调试”。<br />4、手机通过数据线连接电脑，勾选“信任设备”，接着运行“解锁.bat”。<br />手机重启后将会进入下面界面，通过音量键选择第二个选项，点击电源键来确认。<br /><img alt="image.png" src="images/1679569868578_9.png"><br />5、手机重启之后和之前一样，不用配置任何东西，一路跳过。（<strong>不要插SIM卡</strong>！<strong>不要联网</strong>！<strong>不要设置指纹密码</strong> ！）
<a name="NwxSZ"></a></p>
<h3>2.2.3 刷入TWRP</h3>
<p>1、打开“开发者选项”，开启“USB调试”。手机通过数据线连接电脑，勾选“信任设备”，刷入TWRP：<code>fastboot flash boot .\twrp-3.7.0_11-0-enchilada.img</code>  <br />2、手机将重启进入如下页面。<br /><img alt="image.png" src="images/1679569868758_10.png"><br />3、通过音量键选择“Recovery mode”模式，电源键确定，手机会重启进入临时TWRP。 <br /><img alt="image.png" src="images/1679569869094_11.png"><br />4、滑动进去主页面，选择“Wipe”，然后滑动进行“双清”，完成后返回再进行“格式化Data”。<br /><img alt="image.png" src="images/1679569869386_12.png">
<a name="LzqGe"></a></p>
<h3>2.2.4 刷入新系统</h3>
<p>1、格式化操作完成后，回退到主页面。<br /><img alt="image.png" src="images/1679569869620_13.png"><br />2、传入OTA包：<code>adb push OnePlus6Oxygen_22_OTA_064_all_bate5.zip /sdcard</code>，等待完成后，进入“Install”，可以看到我们传入的刷机包。<br /><img alt="image.png" src="images/1679569869877_14.png"><br />3、点击刷机包，直接滑动确认刷入。<br /><img alt="image.png" src="images/1679569870145_15.png"><br />4、等到刷机完成后，点击“reboot”选择“B”分区之后重启进去新系统。<br />5、进入系统后和之前一样，不用配置任何东西，一路跳过。（<strong>不要插SIM卡</strong>！<strong>不要联网</strong>！<strong>不要设置指纹密码</strong> ！）<br />6、打开“开发者选项”，开启“USB调试”。手机通过数据线连接电脑，勾选“信任设备”，运行 “刷入TWRP.bat”，和上面的操作一样，进去TWRP页面。<br /><img alt="image.png" src="images/1679569870368_16.png">
<a name="h6CU4"></a></p>
<h3>2.2.5 解密Data和刷入Magisk</h3>
<p>1、根据官方文档，需要刷入“Disable_Dm-Verity_ForceEncrypt_11.02.2020.zip”文件。<br /><img alt="image.png" src="images/1679569870568_17.png"><br />2、运行“adb-push.bat”，会将所需安装包全部拷贝到“/sdcard”目录下。进入“Install”后可以看到这些文件。</p>
<div class="highlight"><pre><span></span><code>adb push Disable_Dm-Verity_ForceEncrypt_11.02.2020.zip /sdcard
adb push OnePlus6Oxygen_22_OTA_064_all_bate5_boot_magisk.img /sdcard
adb push Magisk-v23.0.apk /sdcard
adb push nethunter-2021.4-oneplus6-oos-ten-kalifs-full.zip /sdcard
</code></pre></div>

<p>3、先点击“Disable_Dm-Verity_ForceEncrypt_11.02.2020.zip”，滑动刷入。<br /><img alt="image.png" src="images/1679569870809_18.png"><br />4、接着点击“Install Images”切换，选择“OnePlus6Oxygen_22_OTA_064_all_bate5_boot_magisk.img”镜像，刷入到“boot”分区。<br /><img alt="image.png" src="images/1679569871010_19.png"><br />5、重启手机进入系统，手动安装“Magisk-v23.0.apk”。查看是否获取了root权限，并重启一次手机。（如果重启卡REC，就再刷一次Magisk的boot）
<a name="CuS8O"></a></p>
<h3>2.2.6 刷入Nethunter</h3>
<p>1、数据线连接电脑，运行 “刷入TWRP.bat”，选择“Recovery mode”进去TWRP。再“Install”中刷入“nethunter-2021.4-oneplus6-oos-ten-kalifs-full.zip”。<br /><img alt="image.png" src="images/1679569871262_20.png"><br />2、完成之后重启进入系统。（如果卡LOGO，或者卡TWRP，就重新刷一下Magisk的boot）<br /><img alt="image.png" src="images/1679569871489_21.png"><br />3、进入系统后会发现，除了Magisk之外多了其他四个APP。<br /><img alt="image.png" src="images/1679569871721_22.png"></p>
<ol>
<li>配置好网络后，从F-Droid商店更新NetHunter应用，给NetHunter和终端权限，重启手机即可。
<a name="g1Tkz"></a></li>
</ol>
<h3>2.2.7 安装Kali Chroot</h3>
<p>打开NetHunter App并允许所有申请的权限。在App进入主界面后，打开App侧边栏，选择Kali Chroot <br />Manager就会自动安装上Kali Chroot。在安装完毕后，单击STARTKALI CHROOT启动Chroot。<br /><img alt="image.png" src="images/1679569871929_23.png">
<a name="wnaNU"></a></p>
<h3>2.2.8 开启SSH</h3>
<p>打开“Kali Services”，开启SSH服务，并勾选“RunOnChrootStart”，在Home页面是可以看到自己手机的IP的，用工具连接管理。<br /><img alt="image.png" src="images/1679569872288_24.png">
<a name="wjKFN"></a></p>
<h3>2.2.9 开启KALI桌面</h3>
<p>1、进入“NetHunter”，选择“Kex Manager”：<br /><img alt="image.png" src="images/1679569872479_25.png"><br />2、配置VNC密码：<br /><img alt="image.png" src="images/1679569872679_26.png"><br />3、然后点击“START SERVER”<br /><img alt="image.png" src="images/1679569872927_27.png"><br />4、打开“NetHunter Kex”，填写配置信息，点击“Connect”：<br /><img alt="image.png" src="images/1679569873190_28.png"><br />5、进入KALI 桌面：<br /><img alt="image.png" src="images/1679569873411_29.png"><br />6、对于刚接触刷机的小白来说，刷入Kali Nethunter还是比较困难的。因为网上的教程或多或少，要么就是有些细节问题没有交代清楚，要么是刷机资源找不到就放弃了。毕竟安卓机型种类相对复杂，官方对内核的支持也不是很好，很多情况下还需要根据自己手机的情况，重新刷入内核。不过只要你手上有一台Oneplus6，即使是小白，按照上面的流程刷入，也不会有啥问题。</p>
        </section>
        <!-- BEGIN LINK -->

        <!-- END LINK -->
        <footer class="post-footer">
            <figure class="author-image">
                <a class="img" href="author/jammny.html" style="background-image: url('https://jammny.github.io/images/img.png')"><span class="hidden">jammny's Picture</span></a>
            </figure>
            <section class="author">
                <h4>
                    <a href="author/jammny.html">jammny</a>
                </h4>
                <p>Fighter安全团队</p>
                <div class="author-meta">
                    <span class="author-location icon-location">China</span>                 </div>
            </section>
            <section class="share">
                <h4>Share this post</h4>
                <a class="icon-twitter" href="https://twitter.com/share?text=%E7%A7%BB%E5%8A%A8%E5%AE%89%E5%85%A8%20%7C%20%E5%AE%89%E5...%20via%20%40&amp;url=./yi-dong-an-quan-an-zhuo-ce-shi-huan-jing-da-jian.html" onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
                    <span class="hidden">Twitter</span>
                </a>
                <a class="icon-facebook" href="https://www.facebook.com/sharer/sharer.php?u=./yi-dong-an-quan-an-zhuo-ce-shi-huan-jing-da-jian.html" onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
                    <span class="hidden">Facebook</span>
                </a>
                <a class="icon-google-plus" href="https://plus.google.com/share?url=./yi-dong-an-quan-an-zhuo-ce-shi-huan-jing-da-jian.html" onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;">
                    <span class="hidden">Google+</span>
                </a>
            </section>
        </footer>
    </article>
</main>
<aside class="read-next">
    <!-- a class="read-next-story" style="background-image: url('')" href="./pythongong-ju-kai-fa-duan-kou-sao-miao.html" -->
    <a class="read-next-story" href="./pythongong-ju-kai-fa-duan-kou-sao-miao.html">
        <section class="post">
            <h2>Python工具开发 | 端口扫描</h2>
            <!-- p><p><code>原创声明：转载本文请标注出处和作者，望尊重作者劳动成果！感谢！</code></p>
<blockquote>
<p>前言：打算以python语言为主，0 到 1 写一个信息收集工具开发系列。本 …</p></blockquote></p -->
        </section>
    </a>
</aside>             <footer class="site-footer clearfix" role="contentinfo" itemscope itemtype="http://schema.org/WPFooter">
                <section class="copyright">
                    <a itemprop="url" href="http://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">
                        CC Attribution-NonCommercial-ShareAlike 4.0 International License</a>.
                </section>
                <section class="poweredby">
                    Proudly published with
                    <a itemprop="url" href="https://getpelican.org" target="_blank">Pelican</a>
                </section>
            </footer>
        </div>
    <script type="text/javascript" src="./theme/js/jquery-1.11.2.min.js"></script>
    <script type="text/javascript" src="./theme/js/jquery.fitvids.min.js"></script>
    <script type="text/javascript" src="./theme/js/index.min.js"></script>
    </body>
</html>